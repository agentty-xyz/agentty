{% extends "base.html" %}
{% macro render_docs_nav(section_path, current_permalink, nested=false) %}
    {% set docs_nav_section = get_section(path=section_path) %}
    {% if nested %}
        <h3 class="m-0 mt-4 mb-2 text-[1rem] font-semibold tracking-[0.03em] text-accent">{{ docs_nav_section.title }}</h3>
    {% endif %}
    {% if docs_nav_section.pages | length > 0 %}
        {% if nested %}
            <ul class="m-0 ml-3 p-0 list-none space-y-2 border-l border-border pl-3">
            {% else %}
                <ul class="m-0 p-0 list-none space-y-2">
                {% endif %}
                {% for docs_page in docs_nav_section.pages %}
                    <li>
                        <a class="block text-[0.9rem] leading-snug no-underline {% if docs_page.permalink == current_permalink %}text-accent font-medium{% else %}text-muted hover:text-accent{% endif %}"
                           href="{{ docs_page.permalink }}">{{ docs_page.title }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
        {% for subsection_path in docs_nav_section.subsections %}
            {{ self::render_docs_nav(section_path=subsection_path, current_permalink=current_permalink, nested=true) }}
        {% endfor %}
    {% endmacro render_docs_nav %}
    {% block title %}
        {{ page.title }} | {{ config.title }} Docs
    {% endblock title %}
    {% block canonical %}
        {{ page.permalink }}
    {% endblock canonical %}
    {% block extra_css %}
        /* Keep inline and fenced markdown code visually distinct from body copy. */
        .docs-content :not(pre) > code {
        display: inline-block;
        border: 1px solid var(--color-border);
        border-radius: 0.3rem;
        background-color: var(--color-surface);
        color: var(--color-accent);
        padding: 0 0.35rem;
        line-height: 1.4;
        font-size: 0.92em;
        }
        .docs-content pre {
        margin: 1rem 0;
        border: 1px solid var(--color-border);
        border-radius: 0.5rem;
        background-color: var(--color-surface);
        padding: 0.85rem 1rem;
        overflow-x: auto;
        }
        .docs-content pre code {
        display: inline;
        border: 0;
        border-radius: 0;
        background: transparent;
        color: inherit;
        padding: 0;
        font-size: 0.92rem;
        line-height: 1.6;
        }
        /*
        * Zola's syntax-highlighting docs require these classes for class-based
        * output and line numbers.
        */
        .docs-content .giallo-l {
        display: inline-block;
        min-height: 1lh;
        width: 100%;
        }
        .docs-content .giallo-ln {
        display: inline-block;
        user-select: none;
        margin-right: 0.4em;
        padding: 0.4em;
        min-width: 3ch;
        text-align: right;
        opacity: 0.8;
        }
        /* Restore clear heading hierarchy inside rendered markdown content. */
        .docs-content h2,
        .docs-content h3,
        .docs-content h4 {
        color: var(--color-accent);
        font-weight: 600;
        line-height: 1.35;
        margin-bottom: 0.45rem;
        }
        .docs-content h2 {
        font-size: 1.18rem;
        margin-top: 1.7rem;
        }
        .docs-content h3 {
        font-size: 1.04rem;
        margin-top: 1.45rem;
        }
        .docs-content h4 {
        font-size: 0.98rem;
        margin-top: 1.2rem;
        }
        .docs-content p,
        .docs-content ul,
        .docs-content ol {
        margin: 0.5rem 0 0.9rem;
        }
        .docs-content li + li {
        margin-top: 0.28rem;
        }
        .docs-content .zola-anchor {
        font-size: 0.72em;
        margin-left: 0.45rem;
        opacity: 0.72;
        text-decoration: none;
        vertical-align: middle;
        }
    {% endblock extra_css %}
    {% block page_width_class %}
        max-w-[1080px]
    {% endblock page_width_class %}
    {% block main_width_class %}
        max-w-[1080px]
    {% endblock main_width_class %}
    {% block main_extra_classes %}
        grid gap-8 md:grid-cols-[230px_minmax(0,1fr)]
    {% endblock main_extra_classes %}
    {% block content %}
        <aside class="bg-surface border border-border rounded-[10px] p-4 h-fit">
            <h2 class="m-0 mb-4 text-[1.15rem] font-bold tracking-[0.02em] text-accent">Guides</h2>
            {{ self::render_docs_nav(section_path="docs/_index.md", current_permalink=page.permalink) }}
        </aside>
        <article class="min-w-0">
            <h1 class="text-[1.35rem] m-0">{{ page.title }}</h1>
            <div class="docs-content mt-5 leading-[1.75] text-[0.95rem] text-muted">{{ page.content | safe }}</div>
        </article>
    {% endblock content %}
